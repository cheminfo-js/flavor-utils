!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.flavorUtils=e():t.flavorUtils=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return new Promise(function(r,n){var o=t.databaseUrl;delete e._id,l.post(o).set("Content-Type","application/json").send(e).end(function(t,e){return t?n(t):void r(e.body)})})}function s(t,e,r){var n=e.split("/"),o="_design/"+n[0],s=n[1];return a(t.databaseUrl+"/"+o+"/_view/"+s+"?key="+encodeURIComponent(JSON.stringify(r)))}function i(t,e,r,n){var o=e.split("/"),s="_design/"+o[0],i=o[1];return a(t.databaseUrl+"/"+s+"/_list/"+i+"/"+r+"?key="+encodeURIComponent(JSON.stringify(n)))}function a(t){return new Promise(function(e,r){l.get(t).set("Accept","application/json").end(function(t,n){return t?r(t):void e(n.body)})})}function h(t,e){return new Promise(function(r,n){var o=t.databaseUrl+"/"+e._id;l.del(o).query({rev:e._rev}).end(function(t,e){return t?n(t):void r(e)})})}function u(t,e){return new Promise(function(r,n){var o=t.databaseUrl+"/"+e._id;l.put(o).set("Content-Type","application/json").send(e).end(function(t,e){return t?n(t):void r(e.body)})})}var c=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=r(1),f=r(7),p=r(8),d={designDoc:"flavor"},m=function(){function t(e){n(this,t),this.defaultOptions=e}return c(t,[{key:"getOptions",value:function(t){var e=Object.assign({},d,this.defaultOptions,t),r="";if(e.couchUsername&&(r+=e.couchUsername,e.couchPassword&&(r+=":"+e.couchPassword)),e.couchUrl){var n=p.parse(e.couchUrl);r&&(n.auth=r),e.couchUrl=n.format()}return e.couchUrl&&(e.couchUrl=e.couchUrl.replace(/\/$/,"")),e.couchUrl&&e.couchDatabase&&(e.databaseUrl=e.couchUrl+"/"+e.couchDatabase),e}},{key:"getFlavors",value:function(t){return t=this.getOptions(t),s(t,t.designDoc+"/list",t.username)}},{key:"clone",value:function(t){t.source=this.getOptions(t.source),t.target=this.getOptions(t.target);var e=[t.source.flavor,t.source.username];return s(t.source,t.source.designDoc+"/docs",e).then(function(e){function r(e){return function(){var r,s,i,h,u,c=[];return c.push(a(t.source.databaseUrl+"/"+n[e].id)),n[e].value.view?(r=a(t.source.databaseUrl+"/"+n[e].id+"/view.json"),c.push(r)):c.push(void 0),n[e].value.data?(s=a(t.source.databaseUrl+"/"+n[e].id+"/data.json"),c.push(s)):c.push(void 0),n[e].value.meta?(i=a(t.source.databaseUrl+"/"+n[e].id+"/meta.json"),c.push(i)):c.push(void 0),c=Promise.all(c).then(function(e){h=e[0],u={};var r=e[1],n=e[2],o=e[3];delete h._rev,u.flavors={};var s=[];if(t.target.subFolder&&"string"==typeof t.target.subFolder&&(s=t.target.subFolder.split("/").filter(function(t){return""!==t})),s.length>0&&h.flavors[t.source.flavor]){if(h.flavors[t.source.flavor]){for(var e=h.flavors[t.source.flavor],i=s.length-1;i>=0;i--)e.unshift(s[i]);u.flavors[t.target.flavor]=e}}else h.flavors[t.source.flavor]&&(u.flavors[t.target.flavor]=h.flavors[t.source.flavor]);u.name=t.target.username,o&&(u._attachments=u._attachments||{},u._attachments["meta.json"]={content_type:"application/json",data:f.encode(JSON.stringify(o))}),r&&(u._attachments=u._attachments||{},u._attachments["view.json"]={content_type:"application/json",data:f.encode(JSON.stringify(r))}),n&&(u._attachments=u._attachments||{},u._attachments["data.json"]={content_type:"application/json",data:f.encode(JSON.stringify(n))})}),c.then(function(){return o(t.target,u)})}}var n=e.rows;if(n){var s=Promise.resolve(),i=0;for(i=0;i<n.length;i++)s=s.then(r(i));return s.then(function(){console.log("all done")},function(t){return console.log("error:",t),t}),s}})}},{key:"del",value:function(t){t=this.getOptions(t);var e=[t.flavor,t.username];return s(t,t.designDoc+"/docs",e).then(function(e){function r(e){var r=a(t.databaseUrl+"/"+n[e].id);return r=r.then(function(e){delete e.flavors[t.flavor];var r=Object.keys(e.flavors);return 0===r.length?h(t,e):u(t,e)})}for(var n=e.rows,o=Promise.resolve(),s=0;s<n.length;s++)o=o.then(r(s));return o.then(function(){console.log("delete flavor done")},function(t){console.log("Error!",t,t.stack)}),o})}},{key:"getFlavor",value:function(t,e){t=this.getOptions(t),e=void 0===e?!0:e;var r=[t.flavor,t.username];return e?i(t,t.designDoc+"/sort","docs",r):s(t,t.designDoc+"/docs",r)}},{key:"hasViews",value:function(t){t=this.getOptions(t);var e=[t.flavor,t.username];return s(t,t.designDoc+"/docs",e).then(function(t){return!(t.rows&&0===t.rows.length)})}},{key:"getTree",value:function e(t){function e(t){var e,n={};Object.defineProperty(n,"__root",{enumerable:!1,writable:!0,value:!0});for(var o=0;o<t.length;o++){e=t[o];var s=e.value.flavors;r(s,n,e.value)}return n}function r(t,e,n){if(!t.length)return e.__data=n.data,e.__view=n.view,e.__id=n._id,e.__rev=n._rev,e.__version=n.version,e.__keywords=n.keywords,void(e.__meta=n.meta);var o=t.shift();return e[o]||(e[o]={__name:o,__parents:e.__parents?e.__parents.slice():[],__parent:e},e.__name&&e[o].__parents.push(e.__name)),r(t,e[o],n)}return t.couchUrl?this.getFlavor(t).then(function(t){return t.rows&&(t=t.rows),e(t)}):Promise.resolve(e(t))}},{key:"traverseTree",value:function(t,e,r){var n=this,o=Promise.resolve(),s=function(s){if(s.startsWith("__"))return"continue";var i=t[s];i.__id?e&&(o=o.then(function(){return e(i)})):"__root"!==s&&(r&&(o=o.then(function(){return r(i)})),o=o.then(function(){return n.traverseTree(i,e,r)}))};for(var i in t){s(i)}return o}}]),t}();t.exports=m},function(t,e,r){function n(){}function o(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function s(t){if(!_(t))return t;var e=[];for(var r in t)null!=t[r]&&i(e,r,t[r]);return e.join("&")}function i(t,e,r){return Array.isArray(r)?r.forEach(function(r){i(t,e,r)}):void t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}function a(t){for(var e,r,n={},o=t.split("&"),s=0,i=o.length;i>s;++s)r=o[s],e=r.split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function h(t){var e,r,n,o,s=t.split(/\r?\n/),i={};s.pop();for(var a=0,h=s.length;h>a;++a)r=s[a],e=r.indexOf(":"),n=r.slice(0,e).toLowerCase(),o=w(r.slice(e+1)),i[n]=o;return i}function u(t){return/[\/+]json\b/.test(t)}function c(t){return t.split(/ *; */).shift()}function l(t){return y(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),n=r.shift(),o=r.shift();return n&&o&&(t[n]=o),t},{})}function f(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=h(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function p(t,e){var r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new f(r)}catch(n){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=n,t.rawResponse=r.xhr&&r.xhr.responseText?r.xhr.responseText:null,t.statusCode=r.xhr&&r.xhr.status?r.xhr.status:null,r.callback(t)}if(r.emit("response",e),t)return r.callback(t,e);if(e.status>=200&&e.status<300)return r.callback(t,e);var o=new Error(e.statusText||"Unsuccessful HTTP response");o.original=t,o.response=e,o.status=e.status,r.callback(o,e)})}function d(t,e){var r=b("DELETE",t);return e&&r.end(e),r}var m,v=r(2),y=r(3),g=r(4),_=r(5);m="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var b=t.exports=r(6).bind(null,p);b.getXHR=function(){if(!(!m.XMLHttpRequest||m.location&&"file:"==m.location.protocol&&m.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1};var w="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};b.serializeObject=s,b.parseString=a,b.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},b.serialize={"application/x-www-form-urlencoded":s,"application/json":JSON.stringify},b.parse={"application/x-www-form-urlencoded":a,"application/json":JSON.parse},f.prototype.get=function(t){return this.header[t.toLowerCase()]},f.prototype.setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=c(e);var r=l(e);for(var n in r)this[n]=r[n]},f.prototype.parseBody=function(t){var e=b.parse[this.type];return!e&&u(this.type)&&(e=b.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null},f.prototype.setStatusProperties=function(t){1223===t&&(t=204);var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},f.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n="cannot "+e+" "+r+" ("+this.status+")",o=new Error(n);return o.status=this.status,o.method=e,o.url=r,o},b.Response=f,v(p.prototype);for(var x in g)p.prototype[x]=g[x];p.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},p.prototype.type=function(t){return this.set("Content-Type",b.types[t]||t),this},p.prototype.responseType=function(t){return this._responseType=t,this},p.prototype.accept=function(t){return this.set("Accept",b.types[t]||t),this},p.prototype.auth=function(t,e,r){switch(r||(r={type:"basic"}),r.type){case"basic":var n=btoa(t+":"+e);this.set("Authorization","Basic "+n);break;case"auto":this.username=t,this.password=e}return this},p.prototype.query=function(t){return"string"!=typeof t&&(t=s(t)),t&&this._query.push(t),this},p.prototype.attach=function(t,e,r){return this._getFormData().append(t,e,r||e.name),this},p.prototype._getFormData=function(){return this._formData||(this._formData=new m.FormData),this._formData},p.prototype.send=function(t){var e=_(t),r=this._header["content-type"];if(e&&_(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this._header["content-type"],"application/x-www-form-urlencoded"==r?this._data=this._data?this._data+"&"+t:t:this._data=(this._data||"")+t):this._data=t;return!e||o(t)?this:(r||this.type("json"),this)},f.prototype.parse=function(t){return m.console&&console.warn("Client-side parse() method has been renamed to serialize(). This method is not compatible with superagent v2.0"),this.serialize(t),this},f.prototype.serialize=function(t){return this._parser=t,this},p.prototype.callback=function(t,e){var r=this._callback;this.clearTimeout(),r(t,e)},p.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},p.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},p.prototype.withCredentials=function(){return this._withCredentials=!0,this},p.prototype.end=function(t){var e=this,r=this.xhr=b.getXHR(),s=this._query.join("&"),i=this._timeout,a=this._formData||this._data;this._callback=t||n,r.onreadystatechange=function(){if(4==r.readyState){var t;try{t=r.status}catch(n){t=0}if(0==t){if(e.timedout)return e.timeoutError();if(e.aborted)return;return e.crossDomainError()}e.emit("end")}};var h=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),t.direction="download",e.emit("progress",t)};this.hasListeners("progress")&&(r.onprogress=h);try{r.upload&&this.hasListeners("progress")&&(r.upload.onprogress=h)}catch(c){}if(i&&!this._timer&&(this._timer=setTimeout(function(){e.timedout=!0,e.abort()},i)),s&&(s=b.serializeObject(s),this.url+=~this.url.indexOf("?")?"&"+s:"?"+s),this.username&&this.password?r.open(this.method,this.url,!0,this.username,this.password):r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof a&&!o(a)){var l=this._header["content-type"],f=this._parser||b.serialize[l?l.split(";")[0]:""];!f&&u(l)&&(f=b.serialize["application/json"]),f&&(a=f(a))}for(var p in this.header)null!=this.header[p]&&r.setRequestHeader(p,this.header[p]);return this._responseType&&(r.responseType=this._responseType),this.emit("request",this),r.send("undefined"!=typeof a?a:null),this},b.Request=p,b.get=function(t,e,r){var n=b("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},b.head=function(t,e,r){var n=b("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},b.del=d,b["delete"]=d,b.patch=function(t,e,r){var n=b("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},b.post=function(t,e,r){var n=b("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},b.put=function(t,e,r){var n=b("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}},function(t,e,r){function n(t){return t?o(t):void 0}function o(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,o=0;o<r.length;o++)if(n=r[o],n===e||n.fn===e){r.splice(o,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r){r=r.slice(0);for(var n=0,o=r.length;o>n;++n)r[n].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){t.exports=function(t,e,r){for(var n=0,o=t.length,s=3==arguments.length?r:t[n++];o>n;)s=e.call(null,s,t[n],++n,t);return s}},function(t,e,r){var n=r(5);e.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},e.parse=function(t){return this._parser=t,this},e.timeout=function(t){return this._timeout=t,this},e.then=function(t,e){return this.end(function(r,n){r?e(r):t(n)})},e.use=function(t){return t(this),this},e.get=function(t){return this._header[t.toLowerCase()]},e.getHeader=e.get,e.set=function(t,e){if(n(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},e.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},e.field=function(t,e){return this._getFormData().append(t,e),this}},function(t,e){function r(t){return null!=t&&"object"==typeof t}t.exports=r},function(t,e){function r(t,e,r){return"function"==typeof r?new t("GET",e).end(r):2==arguments.length?new t("GET",e):new t(e,r)}t.exports=r},function(t,e){"use strict";var r=t.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var e,n,o,s,i,a,h,u="",c=0;for(t=r._utf8_encode(t);c<t.length;)e=t.charCodeAt(c++),n=t.charCodeAt(c++),o=t.charCodeAt(c++),s=e>>2,i=(3&e)<<4|n>>4,a=(15&n)<<2|o>>6,h=63&o,isNaN(n)?a=h=64:isNaN(o)&&(h=64),u=u+this._keyStr.charAt(s)+this._keyStr.charAt(i)+this._keyStr.charAt(a)+this._keyStr.charAt(h);return u},decode:function(t){var e,n,o,s,i,a,h,u="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)s=this._keyStr.indexOf(t.charAt(c++)),i=this._keyStr.indexOf(t.charAt(c++)),a=this._keyStr.indexOf(t.charAt(c++)),h=this._keyStr.indexOf(t.charAt(c++)),e=s<<2|i>>4,n=(15&i)<<4|a>>2,o=(3&a)<<6|h,u+=String.fromCharCode(e),64!=a&&(u+=String.fromCharCode(n)),64!=h&&(u+=String.fromCharCode(o));return u=r._utf8_decode(u)},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},_utf8_decode:function(t){for(var e="",r=0,n=0,o=0;r<t.length;)if(n=t.charCodeAt(r),128>n)e+=String.fromCharCode(n),r++;else if(n>191&&224>n)o=t.charCodeAt(r+1),e+=String.fromCharCode((31&n)<<6|63&o),r+=2;else{o=t.charCodeAt(r+1);var s=t.charCodeAt(r+2);e+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&s),r+=3}return e}}},function(t,e,r){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,r){if(t&&u(t)&&t instanceof n)return t;var o=new n;return o.parse(t,e,r),o}function s(t){return h(t)&&(t=o(t)),t instanceof n?t.format():n.prototype.format.call(t)}function i(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}function h(t){return"string"==typeof t}function u(t){return"object"==typeof t&&null!==t}function c(t){return null===t}function l(t){return null==t}var f=r(9);e.parse=o,e.resolve=i,e.resolveObject=a,e.format=s,e.Url=n;var p=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","	"],v=["{","}","|","\\","^","`"].concat(m),y=["'"].concat(v),g=["%","/","?",";","#"].concat(y),_=["/","?","#"],b=255,w=/^[a-z0-9A-Z_-]{0,63}$/,x=/^([a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},j={javascript:!0,"javascript:":!0},k={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},O=r(11);n.prototype.parse=function(t,e,r){if(!h(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t;n=n.trim();var o=p.exec(n);if(o){o=o[0];var s=o.toLowerCase();this.protocol=s,n=n.substr(o.length)}if(r||o||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var i="//"===n.substr(0,2);!i||o&&j[o]||(n=n.substr(2),this.slashes=!0)}if(!j[o]&&(i||o&&!k[o])){for(var a=-1,u=0;u<_.length;u++){var c=n.indexOf(_[u]);-1!==c&&(-1===a||a>c)&&(a=c)}var l,d;d=-1===a?n.lastIndexOf("@"):n.lastIndexOf("@",a),-1!==d&&(l=n.slice(0,d),n=n.slice(d+1),this.auth=decodeURIComponent(l)),a=-1;for(var u=0;u<g.length;u++){var c=n.indexOf(g[u]);-1!==c&&(-1===a||a>c)&&(a=c)}-1===a&&(a=n.length),this.host=n.slice(0,a),n=n.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\./),u=0,A=v.length;A>u;u++){var T=v[u];if(T&&!T.match(w)){for(var U="",q=0,E=T.length;E>q;q++)U+=T.charCodeAt(q)>127?"x":T[q];if(!U.match(w)){var S=v.slice(0,u),P=v.slice(u+1),R=T.match(x);R&&(S.push(R[1]),P.unshift(R[2])),P.length&&(n="/"+P.join(".")+n),this.hostname=S.join(".");break}}}if(this.hostname.length>b?this.hostname="":this.hostname=this.hostname.toLowerCase(),!m){for(var D=this.hostname.split("."),I=[],u=0;u<D.length;++u){var H=D[u];I.push(H.match(/[^A-Za-z0-9_-]/)?"xn--"+f.encode(H):H)}this.hostname=I.join(".")}var L=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+L,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!C[s])for(var u=0,A=y.length;A>u;u++){var z=y[u],X=encodeURIComponent(z);X===z&&(X=escape(z)),n=n.split(z).join(X)}var M=n.indexOf("#");-1!==M&&(this.hash=n.substr(M),n=n.slice(0,M));var N=n.indexOf("?");if(-1!==N?(this.search=n.substr(N),this.query=n.substr(N+1),e&&(this.query=O.parse(this.query)),n=n.slice(0,N)):e&&(this.search="",this.query={}),n&&(this.pathname=n),k[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",H=this.search||"";this.path=L+H}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&u(this.query)&&Object.keys(this.query).length&&(s=O.stringify(this.query));var i=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||k[e])&&o!==!1?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),i&&"?"!==i.charAt(0)&&(i="?"+i),r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),i=i.replace("#","%23"),e+o+r+i+n},n.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(h(t)){var e=new n;e.parse(t,!1,!0),t=e}var r=new n;if(Object.keys(this).forEach(function(t){r[t]=this[t]},this),r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(r[e]=t[e])}),k[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(t.protocol&&t.protocol!==r.protocol){if(!k[t.protocol])return Object.keys(t).forEach(function(e){r[e]=t[e]}),r.href=r.format(),r;if(r.protocol=t.protocol,t.host||j[t.protocol])r.pathname=t.pathname;else{for(var o=(t.pathname||"").split("/");o.length&&!(t.host=o.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),r.pathname=o.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var s=r.pathname||"",i=r.search||"";r.path=s+i}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var a=r.pathname&&"/"===r.pathname.charAt(0),u=t.host||t.pathname&&"/"===t.pathname.charAt(0),f=u||a||r.host&&t.pathname,p=f,d=r.pathname&&r.pathname.split("/")||[],o=t.pathname&&t.pathname.split("/")||[],m=r.protocol&&!k[r.protocol];if(m&&(r.hostname="",r.port=null,r.host&&(""===d[0]?d[0]=r.host:d.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===o[0]?o[0]=t.host:o.unshift(t.host)),t.host=null),f=f&&(""===o[0]||""===d[0])),u)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,d=o;else if(o.length)d||(d=[]),d.pop(),d=d.concat(o),r.search=t.search,r.query=t.query;else if(!l(t.search)){if(m){r.hostname=r.host=d.shift();var v=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return r.search=t.search,r.query=t.query,c(r.pathname)&&c(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!d.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var y=d.slice(-1)[0],g=(r.host||t.host)&&("."===y||".."===y)||""===y,_=0,b=d.length;b>=0;b--)y=d[b],"."==y?d.splice(b,1):".."===y?(d.splice(b,1),_++):_&&(d.splice(b,1),_--);if(!f&&!p)for(;_--;_)d.unshift("..");!f||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),g&&"/"!==d.join("/").substr(-1)&&d.push("");var w=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(m){r.hostname=r.host=w?"":d.length?d.shift():"";var v=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return f=f||r.host&&d.length,f&&!w&&d.unshift(""),d.length?r.pathname=d.join("/"):(r.pathname=null,r.path=null),c(r.pathname)&&c(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=d.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,r){var n;(function(t,o){!function(s){function i(t){throw RangeError(S[t])}function a(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function h(t,e){var r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(E,".");var o=t.split("."),s=a(o,e).join(".");return n+s}function u(t){for(var e,r,n=[],o=0,s=t.length;s>o;)e=t.charCodeAt(o++),e>=55296&&56319>=e&&s>o?(r=t.charCodeAt(o++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--)):n.push(e);return n}function c(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=D(t>>>10&1023|55296),t=56320|1023&t),e+=D(t)}).join("")}function l(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:w}function f(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function p(t,e,r){var n=0;for(t=r?R(t/k):t>>1,t+=R(t/e);t>P*C>>1;n+=w)t=R(t/P);return R(n+(P+1)*t/(t+j))}function d(t){var e,r,n,o,s,a,h,u,f,d,m=[],v=t.length,y=0,g=A,_=O;for(r=t.lastIndexOf(T),0>r&&(r=0),n=0;r>n;++n)t.charCodeAt(n)>=128&&i("not-basic"),m.push(t.charCodeAt(n));for(o=r>0?r+1:0;v>o;){for(s=y,a=1,h=w;o>=v&&i("invalid-input"),u=l(t.charCodeAt(o++)),(u>=w||u>R((b-y)/a))&&i("overflow"),y+=u*a,f=_>=h?x:h>=_+C?C:h-_,!(f>u);h+=w)d=w-f,a>R(b/d)&&i("overflow"),a*=d;e=m.length+1,_=p(y-s,e,0==s),R(y/e)>b-g&&i("overflow"),g+=R(y/e),y%=e,m.splice(y++,0,g)}return c(m)}function m(t){var e,r,n,o,s,a,h,c,l,d,m,v,y,g,_,j=[];for(t=u(t),v=t.length,e=A,r=0,s=O,a=0;v>a;++a)m=t[a],128>m&&j.push(D(m));for(n=o=j.length,o&&j.push(T);v>n;){for(h=b,a=0;v>a;++a)m=t[a],m>=e&&h>m&&(h=m);for(y=n+1,h-e>R((b-r)/y)&&i("overflow"),r+=(h-e)*y,e=h,a=0;v>a;++a)if(m=t[a],e>m&&++r>b&&i("overflow"),m==e){for(c=r,l=w;d=s>=l?x:l>=s+C?C:l-s,!(d>c);l+=w)_=c-d,g=w-d,j.push(D(f(d+_%g,0))),c=R(_/g);j.push(D(f(c,0))),s=p(r,y,n==o),r=0,++n}++r,++e}return j.join("")}function v(t){return h(t,function(t){return U.test(t)?d(t.slice(4).toLowerCase()):t})}function y(t){return h(t,function(t){return q.test(t)?"xn--"+m(t):t})}var g=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof o&&o);(g.global===g||g.window===g||g.self===g)&&(s=g);var _,b=2147483647,w=36,x=1,C=26,j=38,k=700,O=72,A=128,T="-",U=/^xn--/,q=/[^\x20-\x7E]/,E=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=w-x,R=Math.floor,D=String.fromCharCode;_={version:"1.3.2",ucs2:{decode:u,encode:c},decode:d,encode:m,toASCII:y,toUnicode:v},n=function(){return _}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))}(this)}).call(e,r(10)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,r){"use strict";e.decode=e.parse=r(12),e.encode=e.stringify=r(13)},function(t,e){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var i=/\+/g;t=t.split(e);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var h=t.length;a>0&&h>a&&(h=a);for(var u=0;h>u;++u){var c,l,f,p,d=t[u].replace(i,"%20"),m=d.indexOf(n);m>=0?(c=d.substr(0,m),l=d.substr(m+1)):(c=d,l=""),f=decodeURIComponent(c),p=decodeURIComponent(l),r(s,f)?Array.isArray(s[f])?s[f].push(p):s[f]=[s[f],p]:s[f]=p}return s}},function(t,e){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,o){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(o){var s=encodeURIComponent(r(o))+n;return Array.isArray(t[o])?t[o].map(function(t){return s+encodeURIComponent(r(t))}).join(e):s+encodeURIComponent(r(t[o]))}).join(e):o?encodeURIComponent(r(o))+n+encodeURIComponent(r(t)):""}}])});
//# sourceMappingURL=flavor-utils.min.js.map